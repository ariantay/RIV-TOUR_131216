<!DOCTYPE html>
<html>
    <head>
        <title>Device Properties Example</title> 
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
        <script type="text/javascript" charset="utf-8">
		document.addEventListener("deviceready", onDeviceReady, false);    
		var watchID = null;
		function onDeviceReady() {
			var options = { enableHighAccuracy: true };
			watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
		}
		
        function onSuccess(position) {
            var element = document.getElementById('geolocation');
            element.innerHTML = 'Latitude: '  + position.coords.latitude      + '<br />' +
            'Longitude: ' + position.coords.longitude     + '<br />' +
            'Distance from Cabin Sushi in feet: ' + getDistanceFromLatLonInFeet(position.coords.latitude,position.coords.longitude,33.981197,-117.376176)     + '<br />' +
            '<hr />'      + element.innerHTML;
			//triggers url change here
			if (getDistanceFromLatLonInFeet(position.coords.latitude,position.coords.longitude,33.981197,-117.376176) < 240) {
				location.href="index.html#employees/3"
			}
        }

        function clearWatch() {
			//this.location.href="index.html#employees/3"
			//$(window).location.href="index.html#employees/3"
			console.log('test');
            if (watchID != null) {
                navigator.geolocation.clearWatch(watchID);
                watchID = null;
            }
        }

        function onError(error) {
            alert('code: '    + error.code    + '\n' +
                  'message: ' + error.message + '\n');
        }

        function getDistanceFromLatLonInFeet(lat1,lon1,lat2,lon2) {
            var R = 6371; // Radius of the earth in km
            var dLat = deg2rad(lat2-lat1);  // deg2rad below
            var dLon = deg2rad(lon2-lon1);
            var a =
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
            Math.sin(dLon/2) * Math.sin(dLon/2)
            ;
            var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            var d = R * c * 3280.8; // Distance in feet
            return d;
        }
        
        function deg2rad(deg) {
            return deg * (Math.PI/180)
        }
        
        
     </script>
    </head>
    <body>
        <p id="geolocation">Watching geolocation...</p>
        <button onclick="clearWatch();">Clear Watch</button>
    </body>
</html>
